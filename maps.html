<!DOCTYPE html>
<html>
  <head>
    <style type="text/css">
      html, body { height: 100%; margin: 0; padding: 0; }
      #map { height: 100%; }
    </style>
  </head>
  <body>
    <div id="map"></div>
    <script type="text/javascript">

function getUrlParameter(sParam) {
    var sPageURL = decodeURIComponent(window.location.search.substring(1)),
        sURLVariables = sPageURL.split('&'),
        sParameterName,
        i;
    for (i = 0; i < sURLVariables.length; i++) {
        sParameterName = sURLVariables[i].split('=');

        if (sParameterName[0] === sParam) {
            return sParameterName[1] === undefined ? true : sParameterName[1];
        }
    }
};

var map;
function initMap() {
  console.log(getUrlParameter('dataD'))
  var dataD = getUrlParameter('dataD').split('_');
  console.log('dataD[0]', dataD[0])
  console.log('dataD[1]', dataD[1])
  map = new google.maps.Map(document.getElementById('map'), {
    //sarÃ  centrata sul nodo di destinazione
    center: {lat: parseFloat(dataD[0]), lng: parseFloat(dataD[1])},
    zoom: 13
  });

  var dataD = getUrlParameter('dataD').split('_');
  var marker = new google.maps.Marker({
    map: map,
    animation: google.maps.Animation.DROP,
    position: {lat: parseFloat(dataD[0]), lng: parseFloat(dataD[1])},
    title: 'Destinazione',
    label: 'D'
  });

  var dataM = getUrlParameter('dataM');
  machineParam = dataM.split('|');
  for (i = 0; i < machineParam.length; i++) {
    var mach_tmp = machineParam[i].split('_');
    var markers = new google.maps.Marker({
      map: map,
      animation: google.maps.Animation.DROP,
      position: {lat: parseFloat(mach_tmp[2]), lng: parseFloat(mach_tmp[3])},
      title: mach_tmp[1],
      label: mach_tmp[0]
    });
  }
  /*
  var infowindow = new google.maps.InfoWindow({
    content: contentString
  });

  marker.addListener('click', function() {
    infowindow.open(map, marker);
  });
*/
}

// Adds a marker to the map.
function addMarker(location, map) {
  // Add the marker at the clicked location, and add the next-available label
  // from the array of alphabetical characters.
  var marker = new google.maps.Marker({
    position: location,
    label: 'id',
    map: map,
    animation: google.maps.Animation.DROP,
    title: 'id'
  });

  var infowindow = new google.maps.InfoWindow({
    content: contentString
  });

  marker.addListener('click', function() {
    infowindow.open(map, marker);
  });
}



    </script>
    <script async defer
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyB27xz94JVRPsuX4qJMMiZpGVoQiQITFb8&callback=initMap">
    </script>
  </body>
</html>
